# AgentsFramework Web Test Interface

这是一个完整的前端测试界面，用于测试 AgentsFramework 项目的所有功能。

## 功能特性

### 🚀 系统监控
- **系统健康检查** - 检查整个系统的健康状态
- **根API信息** - 获取根端点的基本信息  
- **API健康检查** - 检查 API v1 端点的健康状态

### 🔐 用户认证系统
- **用户注册** - 创建新用户账户
- **用户登录** - 用户身份验证
- **自动Token管理** - 登录后自动管理认证token

### 📝 会话管理
- **创建会话** - 创建新的聊天会话
- **获取会话列表** - 显示所有活跃会话
- **更新会话名称** - 修改会话的显示名称
- **删除会话** - 删除不需要的会话
- **会话选择界面** - 可视化会话选择

### 💬 智能聊天
- **普通聊天** - 发送消息并接收响应
- **流式聊天** - 实时流式接收AI响应
- **聊天界面** - 类似现代聊天应用的界面
- **消息历史** - 保持会话内的消息历史
- **清除聊天** - 清空当前聊天记录

### 📊 消息历史管理
- **获取消息历史** - 从服务器获取完整消息历史
- **格式化显示** - 以易读格式显示消息历史

## 使用方法

### 1. 启动后端服务
```bash
# 确保后端服务运行在 http://localhost:8000
cd AgentsFramework
uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
```

### 2. 打开前端界面
```bash
# 直接在浏览器中打开
open web/index.html
# 或者使用本地服务器
python -m http.server 3000 --directory web
```

### 3. 测试流程建议

#### 第一步：系统健康检查
1. 点击 "System Health" 标签
2. 点击 "Check Health" 验证系统状态
3. 点击 "Get Root Info" 获取API基本信息

#### 第二步：用户认证
1. 切换到 "Authentication" 标签
2. 确认API Base URL正确（默认: http://localhost:8000）
3. 注册新用户：
   - 输入邮箱地址
   - 输入强密码（必须包含大小写字母、数字、特殊字符）
   - 点击 "Register"
4. 或者登录已有用户：
   - 输入邮箱和密码
   - 点击 "Login"

#### 第三步：会话管理
1. 切换到 "Sessions" 标签
2. 点击 "Create New Session" 创建聊天会话
3. 点击 "Get All Sessions" 查看所有会话
4. 在会话列表中点击选择活跃会话
5. 测试更新会话名称和删除功能

#### 第四步：聊天测试
1. 切换到 "Chat" 标签
2. 确保有有效的Session Token
3. 在消息框中输入测试消息
4. 测试普通聊天：点击 "Send Message"
5. 测试流式聊天：点击 "Send Stream Message"
6. 观察实时响应效果

#### 第五步：消息历史
1. 切换到 "Message History" 标签
2. 点击 "Get Message History" 查看完整对话历史
3. 验证消息持久化功能

## 技术特性

### 🎨 用户界面
- **响应式设计** - 适配不同屏幕尺寸
- **现代化UI** - 渐变背景、圆角设计、动画效果
- **标签页导航** - 清晰的功能分区
- **实时状态反馈** - 成功/错误/信息提示
- **加载指示器** - 流式聊天时的动画效果

### ⚡ 功能特性
- **自动Token同步** - 登录后自动填充所有需要认证的字段
- **错误处理** - 完善的错误捕获和用户友好提示
- **键盘快捷键** - Ctrl+Enter 发送消息，Enter 提交表单
- **实时流式响应** - 支持服务器端事件流(SSE)
- **会话状态管理** - 可视化会话选择和状态管理

### 🔧 开发特性
- **模块化JavaScript** - 清晰的函数组织
- **RESTful API集成** - 完整覆盖所有后端端点
- **JSON响应格式化** - 易读的API响应显示
- **开发者友好** - 控制台日志和错误信息

## API端点覆盖

### 系统端点
- `GET /` - 根信息
- `GET /health` - 系统健康检查
- `GET /api/v1/health` - API健康检查

### 认证端点
- `POST /api/v1/auth/register` - 用户注册
- `POST /api/v1/auth/login` - 用户登录

### 会话管理端点
- `POST /api/v1/auth/session` - 创建会话
- `GET /api/v1/auth/sessions` - 获取会话列表
- `PATCH /api/v1/auth/session/{id}/name` - 更新会话名称
- `DELETE /api/v1/auth/session/{id}` - 删除会话

### 聊天端点
- `POST /api/v1/chatbot/chat` - 普通聊天
- `POST /api/v1/chatbot/chat/stream` - 流式聊天
- `GET /api/v1/chatbot/messages` - 获取消息历史

## 故障排除

### 常见问题

1. **无法连接到服务器**
   - 检查后端服务是否运行在正确端口
   - 验证API Base URL设置
   - 检查CORS配置

2. **认证失败**
   - 确保密码满足强度要求
   - 检查邮箱格式是否正确
   - 验证token是否过期

3. **流式聊天不工作**
   - 检查浏览器是否支持Fetch API和ReadableStream
   - 验证服务器端事件流配置
   - 查看浏览器控制台错误信息

4. **会话管理问题**
   - 确保有有效的认证token
   - 检查会话ID格式
   - 验证用户权限

### 调试技巧
- 打开浏览器开发者工具查看网络请求
- 检查控制台日志和错误信息
- 使用状态提示信息定位问题
- 验证JSON格式和API响应

## 扩展功能

### 可以添加的功能
- **文件上传测试** - 如果API支持文件上传
- **批量操作** - 批量删除会话等
- **导出功能** - 导出聊天记录
- **主题切换** - 暗色/亮色主题
- **多语言支持** - 国际化界面
- **性能监控** - API响应时间显示

### 自定义配置
- 修改 `getApiUrl()` 函数更改默认API地址
- 调整样式文件自定义界面外观
- 扩展 `getAuthHeaders()` 添加更多认证选项

这个测试界面为 AgentsFramework 项目提供了全面的功能测试能力，帮助开发者和用户验证所有API端点的正确性和稳定性。